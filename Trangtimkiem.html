<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="fileCSS.css">
    <!--link th∆∞ vi·ªán c·ªßa font awsome cho ph√©p s·ª≠ d·ª•ng ICON-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <title>Movies-design</title>
    </head>

    <body>
        <div class="navbar">
            <div class="navbar-container">
                <div class="logo-container"><h1 class="logo">Movies</h1></div>
                <div class="menu-container">
                    <ul class="menu-list">
                        <li class="menu-list-item" id="BOLD"><a href="TRANGWEB.html">Trang ch·ªß</a></li>
                        <li class="menu-list-item"><a href="Trangchitiet.html?id=3">Xem phim</a></li>
                        <li class="menu-list-item"><a href="Tranglienhe.html">Li√™n h·ªá</a></li>
                        <li class="menu-list-item"><a href="TrangTimkiem.html?keyword=f">T√¨m ki·∫øm</a></li>
                    </ul>
                </div>
                <div class="profile-container">
                    <!--thanh t√¨m ki·∫øm-->
                    <form id="search-box">
                    <input type="text" id="search-text" name="keyword" placeholder="T√¨m ki·∫øm..." required autocomplete="off">
                    <button type="submit" id="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                    <ul id="suggestions"></ul> <!-- Hi·ªÉn th·ªã g·ª£i √Ω -->
                    </form>

                    <!--th·∫ª ch·ª©a h√¨nh ·∫£nh sau khi nh·∫≠p t√¨m ki·∫øm-->
                    
                    <div class="toggle">
                        <i class="fas fa-moon toggle-icon"></i>
                        <i class="fas fa-sun toggle-icon"></i>
                        <div class="toggle-ball"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!--ph·∫ßn tr√¨nh chi·∫øu video xem phim khi ta click ch√∫ng ·ªü trang ch·ªß-->
        <div class="container">
            <div class="content-container">
                <div class="movie-list search-page" style="height: 100%;">
                                    
                <!--ph·∫ßn tr·∫£ v·ªÅ k·∫øt qu·∫£ t√¨m ki·∫øm-->

                </div>               
            </div>  
        </div>
        <footer style="background-color: rgba(0,0,0,0); border-top: 2px solid red; color: #777; padding: 20px 0; text-align: center;">
            <div style="max-width: 1000px; margin: auto;">
              <p style="font-size: 18px; margin-bottom: 10px;">üé¨ Website Xem Phim Tr·ª±c Tuy·∫øn</p>
              <p style="font-size: 14px; margin: 5px 0;">Li√™n h·ªá: contact@xemphimonline.vn</p>
              <p style="font-size: 14px; margin: 5px 0;">¬© 2025 XemPhimOnline.vn ‚Äì All rights reserved</p>
              <p style="font-size: 13px; margin-top: 10px;">
                N·ªôi dung tr√™n website ƒë∆∞·ª£c t·ªïng h·ª£p t·ª´ nhi·ªÅungu·ªìn kh√°c nhau v√† ch·ªâ ph·ª•c v·ª• m·ª•c ƒë√≠ch gi·∫£i tr√≠.
              </p>
            </div>
          </footer>
    </body>
</html>
<script src="app.js"></script>
<script>
                            darkLight();
                            const params = new URLSearchParams(window.location.search);
                            const keyword = params.get('keyword');
                            const displayedIds = [];
                            const container = document.querySelector(".search-page");

                            function removeVietnamese(str) {//chuy·ªÉn t·ª´ sang ti·∫øng vi·ªát
                            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "")
                                    .replace(/ƒë/g, "d").replace(/ƒê/g, "D");
                            }

                            function tolower(str) {
                            return removeVietnamese(str).toLowerCase().replace(/\s+/g, '');
                            }

                            function displayfilm(film) {
                                const movieItem = document.createElement("div");
                                movieItem.className = "movie-list-item";
                                // <p class="movie-list-item-desc">${film.description}</p>
                                movieItem.innerHTML = `
                                    <img class="movie-list-item-img" src="${film.poster}">
                                    <span class="movie-list-item-title">${film.title}</span>
                                    <button class="movie-list-item-button" onclick="location.href='Trangchitiet.html?id=${film.id}'">
                                        <i class="fa-solid fa-play"> Xem ngay</i>
                                    </button>
                                `;

                                container.appendChild(movieItem);
                            }

                            // H√†m ƒë·ªá quy t√¨m phim ƒë·ªÅ xu·∫•t li√™n quan
                            function dequyDeXuat(currentMovie) {
                                for (let i = 0; i < movieList.length; i++) {
                                    const movie = movieList[i];

                                    if (!displayedIds.includes(movie.id)) {

                                    // So s√°nh nƒÉm
                                    if (movie.year === currentMovie.year) {
                                        displayfilm(movie);
                                        displayedIds.push(movie.id);
                                        dequyDeXuat(movie);
                                        return;
                                    }

                                    // So s√°nh di·ªÖn vi√™n
                                    for (let j = 0; j < currentMovie.main_cast.length; j++) {
                                        if (movie.main_cast.includes(currentMovie.main_cast[j])) {
                                            displayfilm(movie);
                                            displayedIds.push(movie.id);
                                            dequyDeXuat(movie);
                                            return;
                                        }
                                    }

                                    // So s√°nh th·ªÉ lo·∫°i
                                    for (let j = 0; j < currentMovie.genres.length; j++) {
                                        if (movie.genres.includes(currentMovie.genres[j])) {
                                            displayfilm(movie);
                                            displayedIds.push(movie.id);
                                            dequyDeXuat(movie);
                                            return;
                                        }
                                    }
                                    
                                  }
                                }
                            }

                            // H√†m x·ª≠ l√Ω t√¨m ki·∫øm ch√≠nh
                           function timPhimTheoKeyword(keyword) {
                                container.innerHTML = "";
                                displayedIds.length = 0;

                                const kw = tolower(keyword);

                                for (let i = 0; i < movieList.length; i++) {
                                    const movie = movieList[i];

                                    // So s√°nh ti√™u ƒë·ªÅ, ti√™u ƒë·ªÅ ti·∫øng Anh, ƒë·∫°o di·ªÖn, nh√† s·∫£n xu·∫•t
                                    if (movie.year.toString()===kw||
                                        tolower(movie.title).includes(kw) ||
                                        tolower(movie.title_en).includes(kw) ||
                                        tolower(movie.director).includes(kw) ||
                                        tolower(movie.producer).includes(kw)
                                    ) {
                                        displayfilm(movie);
                                        displayedIds.push(movie.id);
                                        dequyDeXuat(movie);
                                        return;
                                    }

                                    // So s√°nh di·ªÖn vi√™n (main_cast)
                                    for (let j = 0; j < movie.main_cast.length; j++) {
                                        if (tolower(movie.main_cast[j]).includes(kw)) {
                                            displayfilm(movie);
                                            displayedIds.push(movie.id);
                                            dequyDeXuat(movie);
                                            return;
                                        }
                                    }

                                    // So s√°nh th·ªÉ lo·∫°i (genres)
                                    for (let j = 0; j < movie.genres.length; j++) {
                                        if (tolower(movie.genres[j]).includes(kw)) {
                                            displayfilm(movie);
                                            displayedIds.push(movie.id);
                                            dequyDeXuat(movie);
                                            return;
                                        }
                                    }
                                }

                                // N·∫øu kh√¥ng t√¨m th·∫•y phim
                                const noResult = document.createElement("p");
                                noResult.textContent = "Kh√¥ng c√≥ b·ªô phim n√†o ph√π h·ª£p v·ªõi t·ª´ kh√≥a b·∫°n t√¨m ki·∫øm.";
                                container.appendChild(noResult);
                            }


                            // G·∫Øn s·ª± ki·ªán cho n√∫t t√¨m ki·∫øm
                            document.getElementById("search-box").addEventListener("click", function (e) {
                                e.preventDefault();
                                const text = document.getElementById("search-text").value.trim();
                                if (text !== "") {
                                    window.location.href = "Trangtimkiem.html?keyword=" + text;
                                }
                            });

                            // G·ªçi t√¨m ki·∫øm khi trang t·∫£i
                            timPhimTheoKeyword(keyword);
                </script>